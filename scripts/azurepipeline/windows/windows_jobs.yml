# Job template for windows builds
parameters:
  build: ''
  noocl: ''
  python: ''
  

steps:
- script: ${{ ./scripts/azurepipeline/windows/build.cmd /cmake-only parameters.noocl parameters.python parameters.build }}
  displayName: Generating build files with CMake - OpenCL disabled
- task: MSBuild@1
  inputs:
    solution: '..\WindowsCompile\Build_CMake\LuxCore\LuxRays.sln'
    msbuildVersion: '15.0'
    msbuildArchitecture: 'x64'
    platform: 'x64'
    configuration: 'Release'
    msbuildArguments: '/nologo /verbosity:normal /p:WarningLevel=0'
    maximumCpuCount: false # Avoids "Error C1002: compiler out of heap space in pass 2"
    createLogFile: true
  displayName: Building LuxCore - OpenCL disabled
- script: ${{ ./scripts/azurepipeline/windows/post-build.cmd parameters.noocl }}
  displayName: Gathering and packing binaries - OpenCL disabled

